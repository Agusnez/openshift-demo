language: node_js

node_js: "12"

services:
  - docker

install:
  - export DOCKER_FULL_IMAGE_NAME=agusnez/contacts-api
  - docker build -t $DOCKER_FULL_IMAGE_NAME:$TRAVIS_COMMIT .
  - docker build -t $DOCKER_FULL_IMAGE_NAME:latest .

deploy:
  provider: script
  script: bash scripts/docker_push
  on:
    branch: master